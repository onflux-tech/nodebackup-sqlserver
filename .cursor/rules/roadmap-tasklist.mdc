---
description: 
globs: 
alwaysApply: true
---
# Roadmap e Tasklist - Pr√≥ximas Implementa√ß√µes

## üìç Estado Atual (v0.2.2)
**Funcionalidades Implementadas:**
- ‚úÖ Setup inicial interativo via web
- ‚úÖ Interface web com autentica√ß√£o segura
- ‚úÖ Configura√ß√£o criptografada (config.enc)
- ‚úÖ Backup autom√°tico SQL Server (.bak)
- ‚úÖ Compress√£o 7-Zip (.7z)
- ‚úÖ Upload FTP automatizado
- ‚úÖ Agendamento flex√≠vel de backups
- ‚úÖ Instala√ß√£o como servi√ßo Windows
- ‚úÖ Sistema de logs rotacionados
- ‚úÖ **Pol√≠tica de Reten√ß√£o de Backups** (v0.1.0)
  - ‚úÖ Modo Cl√°ssico (sobrescrita) e Modo Reten√ß√£o (timestamp)
  - ‚úÖ Limpeza autom√°tica local e FTP configur√°vel
  - ‚úÖ Interface web completa para configura√ß√£o
  - ‚úÖ Bot√µes de limpeza manual
  - ‚úÖ Documenta√ß√£o completa em `docs/RETENTION_POLICY.md`
- ‚úÖ **Painel de Hist√≥rico Completo** (v0.2.0)
  - ‚úÖ Banco SQLite para persistir hist√≥rico de backups
  - ‚úÖ Estat√≠sticas detalhadas (total, sucessos/falhas, dura√ß√£o m√©dia, tamanho total)
  - ‚úÖ Interface responsiva com filtros por status e pagina√ß√£o
  - ‚úÖ Interface modernizada com tema claro/escuro e fonte Inter
  - ‚úÖ Sidebar responsiva e suporte m√≥vel completo
  - ‚úÖ Sistema de autentica√ß√£o aprimorado com middleware
  - ‚úÖ Cache control para APIs

## üöÄ Roadmap de Desenvolvimento

> **üìå Foco Atual**: Vers√µes 0.x.x para estabiliza√ß√£o e funcionalidades essenciais antes do release v1.0.0 est√°vel.

### üìä **FASE 1: Gerenciamento e Monitoramento** (v0.1.0 - v0.3.0)
*Prioridade: Alta | Estimativa: 6-9 semanas total*

#### ‚úÖ **1.1 Pol√≠tica de Reten√ß√£o** (IMPLEMENTADO v0.1.0)
**Arquivos modificados:** [src/services/database.js](mdc:src/services/database.js), [src/config.js](mdc:src/config.js), [src/services/ftp.js](mdc:src/services/ftp.js), [src/api/routes.js](mdc:src/api/routes.js)

**Implementa√ß√µes conclu√≠das:**
- ‚úÖ **Configura√ß√£o de Reten√ß√£o**
  - ‚úÖ Campo `retention` em config.js com enabled, localDays, ftpDays, autoCleanup, mode
  - ‚úÖ Interface web completa na aba "Pol√≠tica de Reten√ß√£o"
  - ‚úÖ Valida√ß√£o: m√≠nimo 1 dia, m√°ximo 365 dias
  - ‚úÖ Dois modos: Cl√°ssico (sobrescrita) e Reten√ß√£o (timestamp)
  
- ‚úÖ **Limpeza Autom√°tica Local**
  - ‚úÖ M√©todo `cleanupOldBackups()` em database.js
  - ‚úÖ Execu√ß√£o ap√≥s cada backup consolidado (se habilitado)
  - ‚úÖ Log detalhado de arquivos removidos
  - ‚úÖ Parsing inteligente de datas (nome do arquivo e mtime)
  
- ‚úÖ **Limpeza FTP (Opcional)**
  - ‚úÖ M√©todo `cleanupFtpBackups()` em ftp.js
  - ‚úÖ Listagem e remo√ß√£o de arquivos antigos do FTP
  - ‚úÖ Configura√ß√£o opcional (pode manter FTP intacto)
  - ‚úÖ Parsing inteligente de datas FTP (m√∫ltiplos formatos)

- ‚úÖ **Interface de Limpeza Manual**
  - ‚úÖ Rotas `/api/cleanup-local` e `/api/cleanup-ftp`
  - ‚úÖ Bot√µes "üóëÔ∏è Limpar Local" e "üåê Limpar FTP"
  - ‚úÖ Feedback detalhado com contagem de arquivos removidos
  - ‚úÖ Valida√ß√µes e mensagens de erro amig√°veis

#### üìà **1.2 Painel de Hist√≥rico** (IMPLEMENTADO v0.2.2)
**Arquivos implementados:** `src/services/history.js`, `public/history.js`, interface integrada

**Implementa√ß√µes conclu√≠das:**
- ‚úÖ **Banco de Dados Hist√≥rico**
  - ‚úÖ SQLite local para armazenar hist√≥rico completo
  - ‚úÖ Schema: id, timestamp, databases, status, fileSize, duration, errorMessage
  - ‚úÖ Migra√ß√£o autom√°tica na inicializa√ß√£o
  
- ‚úÖ **API de Hist√≥rico**
  - ‚úÖ GET `/api/history` - listar backups paginados com filtros
  - ‚úÖ GET `/api/history/stats` - estat√≠sticas gerais detalhadas
  - ‚úÖ Filtros por data, status e pagina√ß√£o completa
  
- ‚úÖ **Interface Web Modernizada**
  - ‚úÖ Painel de hist√≥rico integrado ao dashboard
  - ‚úÖ Tabela responsiva com filtros e pagina√ß√£o
  - ‚úÖ Modal para visualizar detalhes de erros
  - ‚úÖ Interface com tema claro/escuro
  - ‚úÖ Sidebar responsiva e navega√ß√£o mobile
  - ‚úÖ √çcones Lucide e fonte Inter

#### üìã **1.3 Logs em Tempo Real** (Pr√≥ximo - v0.3.0)
**Arquivos a modificar:** [src/utils/logger.js](mdc:src/utils/logger.js), [public/script.js](mdc:public/script.js)

**Tasklist:**
- [ ] **WebSocket para Logs**
  - [ ] Integrar `socket.io` compat√≠vel Node 12
  - [ ] Stream de logs em tempo real
  - [ ] Filtros por n√≠vel (info, warn, error)
  
- [ ] **Interface de Logs**
  - [ ] Se√ß√£o "Logs ao Vivo" no dashboard
  - [ ] Auto-scroll e pause manual
  - [ ] Download de logs atuais

---

### üìß **FASE 2: Notifica√ß√µes** (v0.4.0 - v0.5.0)
*Prioridade: M√©dia | Estimativa: 5-7 semanas total*

#### ‚úâÔ∏è **2.1 Alertas por E-mail**
**Arquivos a criar:** `src/services/notification.js`, configura√ß√£o SMTP

**Tasklist:**
- [ ] **Configura√ß√£o SMTP**
  - [ ] Adicionar campos SMTP em config.js
  - [ ] Interface web para configurar e-mail
  - [ ] Teste de conex√£o SMTP
  
- [ ] **Templates de E-mail**
  - [ ] Template sucesso: resumo, arquivos, tamanhos
  - [ ] Template falha: erro detalhado, logs relevantes
  - [ ] Template HTML responsivo
  
- [ ] **Integra√ß√£o com Scheduler**
  - [ ] Enviar e-mail ap√≥s cada backup
  - [ ] Configura√ß√£o: sempre, s√≥ falhas, s√≥ sucessos
  - [ ] Rate limiting (evitar spam)

#### üì± **2.2 Integra√ß√£o Telegram/WhatsApp**
**Arquivos a criar:** `src/services/telegram.js`, `src/services/whatsapp.js`

**Tasklist:**
- [ ] **Bot Telegram**
  - [ ] Usar `node-telegram-bot-api` (Node 12 compat√≠vel)
  - [ ] Comandos: /status, /lastbackup, /logs
  - [ ] Configura√ß√£o via Bot Token
  
- [ ] **WhatsApp (API n√£o oficial)**
  - [ ] Integrar biblioteca WhatsApp Web
  - [ ] Mensagens de status via n√∫mero configurado
  - [ ] Fallback se WhatsApp falhar

---

### üìÅ **FASE 3: Expans√£o das Fontes** (v1.1.0+)
*Prioridade: M√©dia | Estimativa: 5-7 semanas* (p√≥s v1.0.0)

#### üóÇÔ∏è **3.1 Backup de Arquivos e Pastas**
**Arquivos a criar:** `src/services/fileBackup.js`, interface sele√ß√£o pastas

**Tasklist:**
- [ ] **Sele√ß√£o de Diret√≥rios**
  - [ ] Interface web para escolher pastas
  - [ ] Exclus√µes por extens√£o/padr√£o
  - [ ] Preview do que ser√° inclu√≠do
  
- [ ] **Inclus√£o no Backup Consolidado**
  - [ ] Comprimir pastas junto com .bak
  - [ ] Manter estrutura de diret√≥rios
  - [ ] Progress indicator para pastas grandes

#### üóÑÔ∏è **3.2 Suporte MySQL e PostgreSQL**
**Arquivos a criar:** `src/services/mysql.js`, `src/services/postgres.js`

**Tasklist:**
- [ ] **MySQL Support**
  - [ ] Usar `mysql2` compat√≠vel Node 12
  - [ ] mysqldump para backup
  - [ ] Interface configura√ß√£o MySQL
  
- [ ] **PostgreSQL Support**
  - [ ] Usar `pg` compat√≠vel Node 12
  - [ ] pg_dump para backup
  - [ ] Interface configura√ß√£o PostgreSQL
  
- [ ] **Seletor de Tipo de Banco**
  - [ ] Interface multi-banco
  - [ ] Valida√ß√£o espec√≠fica por tipo
  - [ ] Backup consolidado multi-tipo

---

### ‚òÅÔ∏è **FASE 4: Expans√£o dos Destinos** (v1.2.0+)
*Prioridade: Baixa | Estimativa: 4-6 semanas* (p√≥s v1.0.0)

#### ü™£ **4.1 Integra√ß√£o S3**
**Arquivos a criar:** `src/services/s3.js`, configura√ß√£o AWS

**Tasklist:**
- [ ] **AWS S3 Support**
  - [ ] Usar `aws-sdk` v2 (Node 12 compat√≠vel)
  - [ ] Upload multipart para arquivos grandes
  - [ ] Configura√ß√£o: bucket, regi√£o, credenciais
  
- [ ] **MinIO/S3 Compat√≠vel**
  - [ ] Support para MinIO e outras S3-likes
  - [ ] Configura√ß√£o de endpoint customizada
  - [ ] Teste de conectividade

#### üìÅ **4.2 Google Drive Integration**
**Arquivos a criar:** `src/services/googleDrive.js`, OAuth setup

**Tasklist:**
- [ ] **Google Drive API**
  - [ ] Usar `googleapis` compat√≠vel Node 12
  - [ ] OAuth 2.0 flow para autoriza√ß√£o
  - [ ] Upload para pasta espec√≠fica
  
- [ ] **Interface OAuth**
  - [ ] Setup inicial via navegador
  - [ ] Renova√ß√£o autom√°tica de tokens
  - [ ] Revoga√ß√£o de acesso

---

### üîÑ **FASE 5: Funcionalidades Avan√ßadas** (v2.0.0+)
*Prioridade: Baixa | Estimativa: 6-8 semanas* (major release)

#### üìÇ **5.1 Interface de Restaura√ß√£o**
**Arquivos a criar:** `src/services/restore.js`, `public/restore.html`

**Tasklist:**
- [ ] **Listagem de Backups**
  - [ ] Listar backups locais e remotos
  - [ ] Preview do conte√∫do do .7z
  - [ ] Informa√ß√µes: data, tamanho, bancos inclu√≠dos
  
- [ ] **Processo de Restaura√ß√£o**
  - [ ] Download autom√°tico se remoto
  - [ ] Extra√ß√£o segura do .7z
  - [ ] Restaura√ß√£o SQL Server com RESTORE DATABASE
  
- [ ] **Interface Web Segura**
  - [ ] Confirma√ß√µes m√∫ltiplas
  - [ ] Log detalhado da restaura√ß√£o
  - [ ] Backup atual antes de restaurar

## üîß Tarefas de Infraestrutura

### **Melhorias Imediatas**
- [ ] **Migrar para Node 16 LTS** (quebra compatibilidade)
- [ ] **Adicionar ESLint** com regras Node 12
- [ ] **Testes Automatizados** (Jest compat√≠vel Node 12)
- [ ] **GitHub Actions** para build autom√°tico
- [ ] **Documenta√ß√£o API** (JSDoc)

### **Melhorias de Performance**
- [ ] **Backup Incremental** (s√≥ mudan√ßas)
- [ ] **Compress√£o Paralela** (m√∫ltiplos cores)
- [ ] **Cache de Configura√ß√µes** (evitar I/O)
- [ ] **Connection Pooling** SQL Server

### **Melhorias de UX**
- [ ] **Wizard de Configura√ß√£o** passo-a-passo
- [ ] **Dark Mode** na interface
- [ ] **Responsividade Mobile** completa
- [ ] **√çcones e Anima√ß√µes** modernas

## üìù Notas de Implementa√ß√£o

### **Compatibilidade Node 12**
- Todas as features devem manter compatibilidade
- Testar com `pkg node12-win-x64` antes de merge
- Evitar depend√™ncias que exijam Node 14+

### **Ordem de Prioridade**
1. **Fase 1** (Monitoramento) - Mais solicitado pelos usu√°rios
2. **Fase 2** (Notifica√ß√µes) - Facilita opera√ß√£o
3. **Fase 3** (Expans√£o fontes) - Novos casos de uso
4. **Fase 4** (Expans√£o destinos) - Cloud adoption
5. **Fase 5** (Avan√ßadas) - Features premium

### **Crit√©rios de Qualidade**
- ‚úÖ Tests unit√°rios para novos servi√ßos
- ‚úÖ Documenta√ß√£o atualizada no README
- ‚úÖ Logs apropriados para debugging
- ‚úÖ Tratamento de erros robusto
- ‚úÖ Interface responsiva e acess√≠vel

## üóìÔ∏è Cronograma Detalhado v0.x.x

### ‚úÖ **v0.1.0 - Pol√≠tica de Reten√ß√£o** (CONCLU√çDO)
**Objetivo**: Implementar limpeza autom√°tica de backups antigos

**Implementa√ß√µes conclu√≠das:**
- ‚úÖ Campo `retention` completo em [src/config.js](mdc:src/config.js)
- ‚úÖ Interface web completa com aba "Pol√≠tica de Reten√ß√£o"
- ‚úÖ Valida√ß√£o: m√≠nimo 1 dia, m√°ximo 365 dias
- ‚úÖ Dois modos: Cl√°ssico (sobrescrita) e Reten√ß√£o (timestamp)
- ‚úÖ M√©todo `cleanupOldBackups()` em [src/services/database.js](mdc:src/services/database.js)
- ‚úÖ M√©todo `cleanupFtpBackups()` em [src/services/ftp.js](mdc:src/services/ftp.js)
- ‚úÖ Rotas API `/api/cleanup-local` e `/api/cleanup-ftp`
- ‚úÖ Bot√µes de limpeza manual na interface
- ‚úÖ Documenta√ß√£o completa em `docs/RETENTION_POLICY.md`
- ‚úÖ Testes e ajustes finais realizados

### ‚úÖ **v0.2.2 - Painel de Hist√≥rico** (CONCLU√çDO)
**Objetivo**: Interface completa para visualizar hist√≥rico de backups

**Implementa√ß√µes conclu√≠das:**
- ‚úÖ Criado `src/services/history.js` com SQLite
- ‚úÖ Schema e migra√ß√£o autom√°tica implementados
- ‚úÖ APIs `/api/history` e `/api/history/stats` funcionais
- ‚úÖ Interface de hist√≥rico integrada ao dashboard
- ‚úÖ Filtros, pagina√ß√£o e modal de detalhes
- ‚úÖ Interface modernizada com tema claro/escuro
- ‚úÖ Sidebar responsiva e suporte m√≥vel
- ‚úÖ Sistema de autentica√ß√£o aprimorado

### **v0.3.0 - Logs Tempo Real** (Estimativa: 2-3 semanas)
**Objetivo**: Stream de logs em tempo real via WebSocket

**Sprint 1 (Semana 1-2)**:
- [ ] Integrar `socket.io` (vers√£o compat√≠vel Node 12)
- [ ] Modificar [src/utils/logger.js](mdc:src/utils/logger.js) para broadcast
- [ ] Sistema de filtros por n√≠vel

**Sprint 2 (Semana 3)**:
- [ ] Interface "Logs ao Vivo" no dashboard
- [ ] Auto-scroll, pause manual e download

### **v0.4.0 - Notifica√ß√µes E-mail** (Estimativa: 2-3 semanas)
**Objetivo**: Alertas autom√°ticos via SMTP

**Sprint 1 (Semana 1-2)**:
- [ ] Criar [src/services/notification.js](mdc:src/services/notification.js)
- [ ] Configura√ß√£o SMTP em config.js
- [ ] Templates HTML responsivos

**Sprint 2 (Semana 3)**:
- [ ] Integra√ß√£o com scheduler
- [ ] Configura√ß√£o: sempre/s√≥ falhas/s√≥ sucessos
- [ ] Rate limiting e testes

### **v0.5.0 - Telegram/WhatsApp** (Estimativa: 3-4 semanas)
**Objetivo**: Notifica√ß√µes por mensageiros

**Sprint 1 (Semana 1-2)**:
- [ ] Bot Telegram com `node-telegram-bot-api` (Node 12)
- [ ] Comandos: /status, /lastbackup, /logs
- [ ] Interface de configura√ß√£o Bot Token

**Sprint 2 (Semana 3-4)**:
- [ ] Integra√ß√£o WhatsApp (biblioteca n√£o oficial)
- [ ] Fallback e tratamento de erros
- [ ] Testes integrados

### **v1.0.0 - Release Est√°vel** (Estimativa: 1-2 semanas)
**Objetivo**: Consolida√ß√£o e estabiliza√ß√£o

- [ ] Refactoring final
- [ ] Documenta√ß√£o completa
- [ ] Testes automatizados (Jest Node 12)
- [ ] Build otimizado e assinado
- [ ] Release oficial est√°vel







